const htmlmin = require("html-minifier");

const shouldTransformHTML = (outputPath) =>
  outputPath &&
  (outputPath.endsWith(".html") || outputPath.endsWith(".php")) &&
  process.env.ELEVENTY_ENV === "production";

process.setMaxListeners(Infinity);
module.exports = {
  htmlmin: function (content, outputPath) {
    if (shouldTransformHTML(outputPath)) {
      return htmlmin.minify(content, {
        useShortDoctype: true,
        removeComments: true,
        collapseWhitespace: true,
      });
    }
    return content;
  },
};
